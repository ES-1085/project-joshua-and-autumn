---
title: 'GOM Contaminated Sediments analysis: Organics'
author: "Joshua Harkness and Autumn Pauly"
date: "2023-10-28"
output: github_document
---

#Loading packages
```{r load-packages-organics}
library(tidyverse)
library(sf)
library(leaflet)
```

#Loading data
```{r load-data-organics}
Organics <- read.csv(paste0("/cloud/project/data/datasets_loc/Organics_loc.csv"), header = T)

Organics <- Organics_loc


```

#Glimpsing initial data
```{r glimpse-data, warning=FALSE}
glimpse(Organics)
```

#Joining the Station Information to the Organics dataset
```{r joining-station-info-organics, warning=FALSE}

Organics_station <- full_join(Station2002, Organics, by = "UNIQUE_ID")

Organics_station <- Organics_station %>%
 pivot_longer(cols = `REPNO_ORG`:`TTBT_C`, 
               names_to = "organic_detected", 
               values_to = "amount_detected")

Organics_station = select(Organics_station, c(UNIQUE_ID, LATITUDE.x, LONGITUDE.x, SOUNDING_M.x, STATE_NAME.x, QUAD_NAME.x, GEN_LOC_NM.x, SPECFC_LOC.x, AREA_CODE.x, SAMP_DATE1.x, TO_SMP_DT2.x, DPTH_N_COR.x, DPTH_CODE.x, COR_GRB_CD.x, organic_detected, amount_detected)) %>%
  mutate(site = fct_recode(GEN_LOC_NM.x,
                           "Rockland to north" = "North of 44; to 50M isobath",
                           "Cape Elizabeth to Rockland" = "43.5N to 44N; to 50M isobath", 
                           "Cape Ann to Cape Elizabeth" = "CAPE ANN to 43.5N", 
                           "Boston Inner Harbor" = "BOSTON INNER HARBOR", 
                           "Cape Code Bay" = "CAPE COD BAY",
                           "Gulf of Maine (>50m Isobath)" = "GULF OF MAINE, >50M ISOBATH",
                           "Northwest Boston Harbor" = "NORTHWEST BOSTON HARBOR",
                           "Southeast Boston Harbor" = "SOUTHEAST BOSTON HARBOR",
                           "Gulf of Maine (<=50m Isobath)" = "GULF OF MAINE, <=50M",
                           "Central Boston Harbor" = "CENTRAL BOSTON HARBOR",
                           "Inland/Rivers" = "INLAND / RIVERS",
                           "Harbor Approaches" = "HARBOR APPROACHES",
                           "Massachusetts Bays" = "MASS BAYS"))

glimpse(Organics_station)

```

``` {r summary-stats-organics}
Sum_Organics <- Organics_station %>%
  group_by(site) %>%
  drop_na(amount_detected) %>%
  summarise(mean_organic = mean(amount_detected),
    sd_organic = sd(amount_detected),
    n_organic = n(),
    SE_organic = sd(amount_detected) / sqrt(n()))

Sum_Organics

```

``` {r pah-gen-loc}
Sum_Organics %>%
  ggplot(aes(x = fct_rev(fct_reorder(site, mean_organic)), y = mean_organic, fill = site))+
  geom_col(col = "black")+
  geom_errorbar(aes(ymin = mean_organic - SE_organic, ymax = mean_organic + SE_organic), width = 0.2)+
  coord_flip()+
  scale_fill_viridis_d()+
  theme_bw()+
  theme(legend.position = "none")+
  labs(title = "Organic Concentrations in Gulf of Maine Sediments",
       x = "General location",
       y = "Mean total Organics concentration ng/g",
       caption = "Error bars = 1 standard error")
```

```{r pah-boston-harbor1}
Sum_Organics %>%
  filter(site %in% c("Boston Inner Harbor", "Central Boston Harbor", "Southeast Boston Harbor", "Northwest Boston Harbor")) %>%
  ggplot(aes(x = fct_rev(fct_reorder(site, mean_organic)), y = mean_organic, fill = site))+
  geom_col(col = "black")+
  geom_errorbar(aes(ymin = mean_organic - SE_organic, ymax = mean_organic + SE_organic), width = 0.2)+
  scale_fill_brewer(type = "qual", palette = 4, direction = 1, aesthetics = "fill")+
  theme_bw()+
  coord_flip()+
  theme(legend.position = "none")+
  labs(title = "Organic Concentrations in Boston Harbor Sediments",
       x = "General location",
       y = "Mean total Organics concentration ng/g",
       caption = "Error bars = 1 standard error")
```

This is attempting to visualize which organics are present. As shown, there is a high abundance of Clostridium perfringens (in units of spores/g) found in all regions. 
``` {r type_of_organic-in-top-four, warning = FALSE}
Organics_station %>%
  filter(site %in% c("Boston Inner Harbor", "Central Boston Harbor", "Southeast Boston Harbor", "Northwest Boston Harbor", "Cape Ann to Cape Elizabeth")) %>%
  ggplot(aes(x = organic_detected, y = amount_detected, fill = site))+
  geom_col()+
  scale_fill_viridis_d()+
  theme_bw()+
  coord_flip()+
  theme(legend.position = "none")+
  labs(title = "Organic Concentrations in Boston Harbor Sediments",
       x = "General location",
       y = "Mean total Organics concentration ng/g",
       caption = "Error bars = 1 standard error")
```
This is trying to visualize the various contaminants that are being found in the Boston Harbor region. 
``` {r facet-organics}
Organics_station %>%
  filter(site %in% c("Boston Inner Harbor", "Central Boston Harbor", "Southeast Boston Harbor", "Northwest Boston Harbor", "Cape Ann to Cape Elizabeth")) %>%
  ggplot(aes(x = site, y = amount_detected, fill = site))+
  geom_col() +
  facet_wrap(.~organic_detected) +
  scale_fill_brewer(type = "qual", palette = 4, direction = 1, aesthetics = "fill")+
  theme_bw()+
  coord_flip()+
  theme(legend.position = "none")+
  labs(title = "Organic Concentrations in Boston Harbor Sediments",
       x = "General location",
       y = "Mean total Organics concentration ng/g")
```


### Specific Locations
This is visualizing the summary of organics found at each location, including the mean, standard deviation, count, and principal square root. 
```{r}
Sum_Organics_site <- Organics_station %>%
  group_by(site) %>%
  drop_na(amount_detected) %>%
  summarise(mean_Organic = mean(amount_detected),
    sd_PAH = sd(amount_detected),
    n_PAH = n(),
    SE_PAH = sd(amount_detected) / sqrt(n()))

Sum_Organics_site
```

## Boston Inner Harbor Concentrations
This plot visualizes the specific organics present in Boston Inner Harbor. 

As shown in the plot, Oil and Grease in sediments (in units of moles/g) has the highest concentration in the harbor, followed by Petroleum Hydrocarbons (in units of percent dry weight), and then Clostridium perfringens (in units of spores/g). 

``` {r type_of_organic-in-boston-inner-harbor, warning = FALSE}
Organics_station %>%
  filter(site %in% c("Boston Inner Harbor")) %>%
  ggplot(aes(x = organic_detected, y = amount_detected, fill = organic_detected))+
  geom_col()+
  coord_flip()+
  theme(legend.position = "none")+
  labs(title = "Organic Concentrations in Boston Inner Harbor Sediments",
       x = "Organic Detected",
       y = "Amount Detected (ng/g)")
```

## Central Boston Harbor Concentrations
This plot visualizes the specific organics present in Boston Central Harbor. 

As shown in the plot, there is a high concentration of Clostridium perfringens (in units of spores/g). There are trace amounts of Polyaromatic Hydrocarbons (PAH) (in units of percent dry weight).
``` {r type_of_organic-in-boston-central-harbor, warning = FALSE}
Organics_station %>%
  filter(site %in% "Central Boston Harbor") %>%
  ggplot(aes(x = organic_detected, y = amount_detected, fill = organic_detected))+
  geom_col() +
  coord_flip()+
  theme(legend.position = "none")+
  labs(title = "Organic Concentrations in Boston Central Harbor Sediments",
       x = "Organic Detected",
       y = "Amount Detected (ng/g)")

```

## Southeast Boston Harbor Concentrations
This plot visualizes the specific organics present in Southeast Boston Harbor. 

As shown in the plot, Clostridium perfringens (89,223 spores/g) has the highest concentration in the harbor, followed by Oil and Grease in sediments (74,285 moles/g), and Petroleum Hydrocarbons (in units of percent dry weight). 
``` {r type_of_organic-in-boston-southeast-harbor, warning = FALSE}
Organics_station %>%
  group_by(site, organic_detected) %>%
  summarise(amount_detected = sum(amount_detected, na.rm = TRUE)) %>%
  filter(site == "Southeast Boston Harbor") %>%
  arrange(desc(amount_detected))

Organics_station %>%
  filter(site %in% c("Southeast Boston Harbor")) %>%
  ggplot(aes(x = organic_detected, y = amount_detected, fill = organic_detected))+
  geom_col()+
  coord_flip()+
  theme(legend.position = "none")+
  labs(title = "Organic Concentrations in Southeast Boston Harbor Sediments",
       x = "Organic Detected",
       y = "Amount Detected (ng/g)")
```

## Northwest Boston Harbor Concentrations
This plot visualizes the specific organics present in Northwest Boston Harbor. 

As shown in the plot, Clostridium perfringens (in units of spores/g) has the highest concentration in the harbor, followed by Oil and Grease in sediments (in units of moles/g), and Petroleum Hydrocarbons (in units of percent dry weight). 

``` {r type_of_organic-in-boston-northwest-harbor, warning = FALSE}
Organics_station %>%
  group_by(site, organic_detected) %>%
  summarise(amount_detected = sum(amount_detected, na.rm = TRUE)) %>%
  filter(site == "Northwest Boston Harbor") %>%
  arrange(desc(amount_detected))

Organics_station %>%
  filter(site %in% c("Northwest Boston Harbor")) %>%
  ggplot(aes(x = organic_detected, y = amount_detected, fill = organic_detected))+
  geom_col()+
  coord_flip()+
  theme(legend.position = "none")+
  labs(title = "Organic Concentrations in Northwest Boston Harbor Sediments",
       x = "Organic Detected",
       y = "Amount Detected (ng/g)")
```

## Cape Ann to Cape Elizabeth Concentrations
This plot visualizes the specific organics present from Cape Ann to Cape Elizabeth. 

As shown in the plot, Clostridium perfringens (in units of spores/g) has the highest concentration in the harbor. There are trace amounts of Petroleum Hydrocarbons (PHC) in units of moles/g.

``` {r type_of_organic-in-cape-ann-to-elizabeth, warning = FALSE}
Organics_station %>%
  group_by(site, organic_detected) %>%
  summarise(amount_detected = sum(amount_detected, na.rm = TRUE)) %>%
  filter(site == "Cape Ann to Cape Elizabeth") %>%
  arrange(desc(amount_detected))

Organics_station %>%
  filter(site %in% c("Cape Ann to Cape Elizabeth")) %>%
  ggplot(aes(x = organic_detected, y = amount_detected, fill = organic_detected))+
  geom_col()+
  coord_flip()+
  theme(legend.position = "none")+
  labs(title = "Organic Concentrations from Cape Ann to Cape Elizabeth",
       x = "Organic Detected",
       y = "Amount Detected (ng/g)")
```