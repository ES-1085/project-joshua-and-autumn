---
title: "GOM Contaminated Sediments analysis"
author: "Joshua Harkness and Autumn Pauly,"
date: "2023-10-20"
output: github_document
---
```{r load-packages}
library(tidyverse)
library(readxl)
library(sf)
```

```{r load-data, warning=FALSE}
stations_full = read_excel("/cloud/project/data/STAT2002.xls", sheet = 2, skip = 3)
sediments_full = read_excel("/cloud/project/data/TXTR2002.xls", sheet = 2, skip = 3)
PCBs_full = read_excel("/cloud/project/data/PCBP2002.xls", sheet = 2, skip = 3)
PAHs_full = read_excel("/cloud/project/data/PAHS2002.xls", sheet = 2, skip = 3)
organics_full = read_excel("/cloud/project/data/GENO2002.xls", sheet = 2, skip = 3)
inorganics_full = read_excel("/cloud/project/data/INOR2002.xls", sheet = 2, skip = 3)
textures_full = read_excel("/cloud/project/data/TXTR2002.xls", sheet = 2, skip = 3)
```
# Creating PCBs dataset with select variables. 
```{r select-var-PCBs}
PCBs = select(PCBs_full, c(UNIQUE_ID, PCB_52_NGG, PCB101_NGG, PCB118_NGG, PCB128_NGG, PCB138_NGG, PCB153_NGG, PCB180_NGG, PCB206_NGG, PCB209_NGG, DDT_4_4_C, DDT_2_4_C, DDE_4_4_C, DDD_4_4_C, ENDRIN_C, ENDR_ALD_C, ALDRIN_C, DIELDRN_C, CLRDNE_T_C, MIREX_C, METHOXYCLC, BHC_A_C, BHC_B_C, BHC_D_C, LINDANE_C))
```
These are the variables within the PCBs dataset that have values -- many have NA values and no zeros.

# Creating Stations2002 dataset with select variables.
```{r select-var-STATs}
Station2002 = select(stations_full, c(UNIQUE_ID, LATITUDE, LONGITUDE, SOUNDING_M, STATE_NAME, QUAD_NAME, GEN_LOC_NM, SPECFC_LOC, AREA_CODE, SAMP_DATE1, TO_SMP_DT2, DPTH_N_COR, DPTH_CODE, COR_GRB_CD))
```

# Creating Texture2002 dataset with select variables.
```{r select-var-TXTR}
Texture2002 = select(textures_full, c(UNIQUE_ID, SAMPLE_WT, SAMP_UNITS, Q1_MM, Q2_MED_MM, Q3_MM, GRN_SI_PCT, SPECIFIC_G, GRAVEL_PCT, SAND_PCT, SILT_PCT, CLAY_PCT, FINES_SIL, SED_CLASS, CLASSIF_S, MEDIAN, MEAN, STDEV_SORT, SKEWNESS, KURTOSIS))
```

# Creating Inorganics2002 dataset with select variables.

```{r select-var-INORG}
#Not going to use this for the time being... will determine if we need these variables in the future. 
#Inorganics2002 = select(inorganics_full, c(UNIQUE_ID, REPL_NO, TOT_REPL, AG_UG_G, AL_UG_G, AS_UG_G, AS_UG_G, AU_UG_G, B_UG_G, BA_UG_G, BE_UG_G, CA_UG_G, CD_UG_G, CL_UG_G, CO_UG_G, CR_UG_G, CU_UG_G, FE_UG_G, HG_UG_G, K_UG_G, LI_UG_G, MG_UG_G, MN_UG_G, MO_UG_G, NA_UG_G, NI_UG_G, P_UG_G, PB_UG_G, RA_UG_G, SB_UG_G, SE_UG_G, SI_UG_G, SN_UG_G, TI_UG_G, TL_UG_G, TH_UG_G, U_UG_G, V_UG_G, ZN_UG_G, C_INOR_PCT, C_ORG_PCT, C_TOT_PCT, VOLAT_PCT, HYDROG_PCT, NITROG_PCT, NH3_MOL_KG, NO3_MOL_KG, O2_MOL_KG, SO2_MOL_KG, SO3_MOL_KG, SO4_MOL_KG, AVS_MOL_G, COD_UG_G, CEC_MOL_KG, SURF_M2_G, TOTSAMP_G, TSOL_WTPCT, WATER_WPCT, R_MOHMS, SP_C_MOHMS, SALIN_PPT, ALK_MEQ_KG, PH, TOTR_MR_HR, ALPHA_PC_G, BETA_PC_G, BULK_RAD_Q))
```

# Creating Organics2002 dataset with select variables.
```{r select-var-ORG}
Organics2002 = select(organics_full, c(UNIQUE_ID, REPNO_ORG, TOTREP_ORG, TVS_EP_PCT, O_G_PCT, O_G_UGG, PHCTOT_PCT, PHCTOT_UGG, PCB_T_UGG, DDT_T_NGG, DDE_T_NGG, DDD_T_NGG, PEST_UG_G, PAHTOT_PCT, PAHTOT_UGG, LIPIDS_NGG, CLOST_SP_G, MBT_C, DBT_C, TBT_C, TTBT_C))
```

# Creating PAHs2002 dataset with select variables.
```{r select-var-ORG}
PAHs2002 = select(PAHs_full, c("UNIQUE ID", BENZNE_C, "2BZTPN_C", "2BZTPN_T_C", C1DIBZTPNC, C2DIBZTPNC, C3DIBZTPNC, "2BZFRN_T_C", NAPHTHLN_C, NPHTLN_T_C, C1NPHTLN_C, "1MTYLNAP_C", "2MTYLNAP_C", C2NPHTLN_C, C3NPHTLN_C, C4NPHTLN_C, BIPHENYL_C, ACNPHTHN_C, ACNPHTYL_C, FLUORENE_C, C1FLORNE_C, C2FLORNE_C, C3FLORNE_C, PHNANTHR_C, "1MT_PHE_C", C2PHNANT_C, C3PHNANT_C, C4PHNANT_C, ANTHRACN_C, BZ_A_ANT_C, "2_AH_ANT_C", PYRENE_C, C1PYRENE_C, BZ_A_PYR_C, BZ_E_PYR_C, IN_123_PYC, "3_4BNZPY_C", FLORNTHN_C, C1FLRNTHNC, BZ_B_FLUOC, BZ_K_FLUOC, CHRYSENE_C, CHRYS_C1_C, CHRYS_C2_C, CHRYS_C3_C, CHRYS_C4_C, PERYLENE_C, BNZ_G_PYLC, B_GHI_PYLC))
```

```{r join-data-frames}
Texture_loc = full_join(Station2002, Texture2002, by = "UNIQUE_ID") %>%
  PCBs_loc = full_join(Texture_loc, PCBs) %>%
  data = full_join(PCBs_loc, PAHs2002) 
```

